<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lectio Divina Mormonis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Times New Roman', 'Crimson Text', Georgia, serif;
            background: linear-gradient(135deg, #8b7355 0%, #5d4e37 50%, #3e2723 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
            transition: background 0.3s ease;
        }
        
        .main-container {
            position: relative; /* For dark mode toggle positioning */
            width: 100%;
            max-width: 768px;
            background: linear-gradient(145deg, #f5f1e8 0%, #e8dcc6 100%);
            border: 3px solid #8b7355;
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.6);
            padding: 32px 40px;
            transition: background 0.3s ease, border-color 0.3s ease;
        }
        
        .selector-page {
            text-align: center;
        }
        
        .main-title {
            font-size: 2.8rem;
            font-weight: 400;
            color: #3e2723;
            margin-bottom: 8px;
            font-variant: small-caps;
            text-shadow: 1px 1px 2px rgba(139, 115, 85, 0.3);
        }
        
        .main-title::after {
            content: '';
            display: block;
            width: 200px;
            height: 2px;
            background: linear-gradient(to right, transparent, #8b7355, transparent);
            margin: 12px auto;
        }
        
        .subtitle {
            color: #5d4e37;
            margin-bottom: 32px;
            font-style: italic;
            font-size: 1.1rem;
            text-align: center;
            font-weight: 300;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }
        
        .form-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #3e2723;
            margin-bottom: 6px;
            font-variant: small-caps;
            letter-spacing: 0.02em;
        }
        
        .form-select {
            border-radius: 4px;
            border: 2px solid #8b7355;
            background: linear-gradient(145deg, #f5f1e8, #e8dcc6);
            padding: 10px 14px;
            font-family: 'Times New Roman', serif;
            font-size: 1rem;
            color: #3e2723;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%235d4e37' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 10px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 35px;
        }
        
        .start-button {
            border-radius: 6px;
            padding: 14px 24px;
            font-weight: 600;
            background: linear-gradient(145deg, #8b7355, #5d4e37);
            color: #f5f1e8;
            border: 2px solid #3e2723;
            cursor: pointer;
            margin-right: 12px;
            font-family: 'Times New Roman', serif;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .start-button:hover {
            background: linear-gradient(145deg, #5d4e37, #3e2723);
            transform: translateY(-1px);
        }
        
        .help-text {
            font-size: 0.875rem;
            color: #5d4e37;
            font-style: italic;
        }
        
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 0.75rem;
            color: #8b7355;
            font-style: italic;
            line-height: 1.4;
        }
        
        .footer a {
            color: #5d4e37;
            text-decoration: none;
            font-weight: 600;
        }
        
        .footer a:hover {
            color: #3e2723;
            text-decoration: underline;
        }
        
        .disclaimer {
            margin-top: 8px;
            font-size: 0.7rem;
            color: #8b7355;
        }
        
        .lectio-page {
            display: none;
            text-align: left;
        }
        
        .nav-bar {
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .back-button {
            border-radius: 4px;
            border: 2px solid #8b7355;
            padding: 8px 16px;
            font-size: 0.9rem;
            color: #3e2723;
            background: linear-gradient(145deg, #f5f1e8, #e8dcc6);
            cursor: pointer;
            font-family: 'Times New Roman', serif;
            box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .back-button:hover {
            background: linear-gradient(145deg, #e8dcc6, #d4c4a8);
            transform: translateY(-1px);
        }
        
        .lectio-header h2 {
            font-size: 2.2rem;
            font-weight: 400;
            color: #3e2723;
            margin-bottom: 8px;
            font-variant: small-caps;
            text-shadow: 1px 1px 2px rgba(139, 115, 85, 0.3);
        }
        
        .lectio-header p {
            color: #5d4e37;
            margin-bottom: 24px;
            font-style: italic;
            font-size: 1rem;
        }
        
        .method-text {
            font-weight: 600;
            color: #3e2723;
        }

        /* RESOURCE SECTIONS - COMPLETELY NEW */
        .resources-container {
            margin-bottom: 32px;
        }

        .resource-category {
            margin-bottom: 32px;
            background: linear-gradient(145deg, rgba(139, 115, 85, 0.08), rgba(93, 78, 55, 0.05));
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(139, 115, 85, 0.2);
        }

        .resource-category:last-child {
            margin-bottom: 0;
        }

        .category-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #3e2723;
            margin-bottom: 16px;
            font-variant: small-caps;
            letter-spacing: 0.03em;
            text-transform: uppercase;
            border-bottom: 2px solid #8b7355;
            padding-bottom: 8px;
            display: block;
        }

        .category-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .resource-button {
            border-radius: 6px;
            padding: 12px 20px;
            color: #f5f1e8;
            font-weight: 600;
            text-decoration: none;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Times New Roman', serif;
            border: 1px solid rgba(0, 0, 0, 0.2);
            font-size: 0.95rem;
            transition: transform 0.2s ease;
        }
        
        .resource-button:hover {
            transform: translateY(-2px);
        }
        
        .gospel-library { 
            background: linear-gradient(145deg, #2d5016, #1a3009);
        }
        
        .book-harder { 
            background: linear-gradient(145deg, #4a3728, #2d1f16);
        }
        
        .book-online { 
            background: linear-gradient(145deg, #1e3a5f, #0f1d30);
        }
        
        .mynoise { 
            background: linear-gradient(145deg, #4c1d95, #3730a3);
        }
        
        .chatgpt { 
            background: linear-gradient(145deg, #10a37f, #0d8b6b);
        }
        
        .learning-to-love { 
            background: linear-gradient(145deg, #059669, #047857);
        }
        
        .seminary-manual { 
            background: linear-gradient(145deg, #40a444, #2d7a30);
        }

        .student-manual {
            background: linear-gradient(145deg, #6d4c41, #4e342e);
        }

        .book-of-mormon-central {
            background: linear-gradient(145deg, #004aad, #002f6c);
        }

        .scripture-citation-index {
             background: linear-gradient(145deg, #a52a2a, #800000);
        }

        .tabernacle-choir {
             background: linear-gradient(145deg, #b8860b, #8b4513);
        }
        
        .ldsbot {
             background: linear-gradient(145deg, #5b21b6, #4c1d95);
        }
        
        .come-follow-me-manual {
            background: linear-gradient(145deg, #003366, #001f3f);
        }
        
        .covenant-of-christ {
            background: linear-gradient(145deg, #c09551, #a07531);
        }

        .parallel-edition {
            background: linear-gradient(145deg, #4682B4, #2E5984);
        }

        .plain-english-version {
            background: linear-gradient(145deg, #6a5acd, #483d8b);
        }

        .gen-z-translate {
            background: linear-gradient(145deg, #ec4899, #db2777);
        }
        
        .book-of-mormon-simplified {
             background: linear-gradient(145deg, #8FBC8F, #2E8B57);
        }

        .grandpa-dave {
             background: linear-gradient(145deg, #B22222, #800000);
        }

        .generate-questions-ai {
             background: linear-gradient(145deg, #3b82f6, #2563eb);
        }
        
        .museum-of-bom {
             background: linear-gradient(145deg, #D2B48C, #8B4513);
        }
        
        .book-of-mormon-videos {
             background: linear-gradient(145deg, #A0522D, #800000);
        }

        .master-class {
             background: linear-gradient(145deg, #FF6347, #DC143C);
        }

        .bom-evidence {
            background: linear-gradient(145deg, #8B0000, #5B0000);
        }

        .bom-art-catalog {
            background: linear-gradient(145deg, #4B0082, #8A2BE2);
        }

        .for-our-day {
            background: linear-gradient(145deg, #0A3D62, #072C47);
        }
        .teachings-bom {
            background: linear-gradient(145deg, #002255, #00112B);
        }
        .teachings-bom-2 {
            background: linear-gradient(145deg, #002a69, #001636);
        }
        .teachings-bom-3 {
            background: linear-gradient(145deg, #00337d, #001b41);
        }
        .teachings-bom-4 {
            background: linear-gradient(145deg, #003c91, #00214c);
        }
        .fair-answers {
            background: linear-gradient(145deg, #16a085, #117a65);
        }
        .lehi-in-desert {
            background: linear-gradient(145deg, #F4A460, #D2691E);
        }
        .approach-bom {
            background: linear-gradient(145deg, #000080, #000033);
        }
        .since-cumorah {
            background: linear-gradient(145deg, #556B2F, #2E401A);
        }
        .prophetic-bom {
            background: linear-gradient(145deg, #800080, #4B0082);
        }
        .byu-speeches {
            background: linear-gradient(145deg, #002244, #001122);
        }
        .general-conference {
            background: linear-gradient(145deg, #333333, #111111);
        }


        .study-section {
            margin-top: 32px;
            background: linear-gradient(145deg, rgba(139, 115, 85, 0.15), rgba(93, 78, 55, 0.1));
            padding: 24px;
            border-radius: 8px;
            border: 2px solid #c4a574;
        }
        
        .study-section h3 {
            color: #3e2723;
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            text-align: center;
            font-variant: small-caps;
            letter-spacing: 0.02em;
            text-shadow: 1px 1px 2px rgba(139, 115, 85, 0.3);
        }
        
        .lectio-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .lectio-step {
            background: linear-gradient(145deg, #f5f1e8, #e8dcc6);
            padding: 24px;
            border-radius: 6px;
            border: 2px solid #8b7355;
            box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .lectio-step h4 {
            color: #3e2723;
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 1.15rem;
            font-variant: small-caps;
            letter-spacing: 0.01em;
        }
        
        .lectio-step p {
            color: #5d4e37;
            font-size: 0.95rem;
            line-height: 1.6;
            font-style: italic;
        }

        .dark-mode-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #f5f1e8;
            border: 2px solid #8b7355;
            color: #8b7355;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .dark-mode-toggle:hover {
            background: #8b7355;
            color: #f5f1e8;
            transform: scale(1.1);
        }
        
        @media (max-width: 640px) {
            .main-container {
                padding: 16px 24px;
            }
            
            .main-title {
                font-size: 2rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .category-buttons {
                flex-direction: column;
            }
            
            .lectio-steps {
                grid-template-columns: 1fr;
            }
        }

        /* Dark Mode Styles (Celestial Knight) */
        body.dark-mode {
            font-family: 'Inter', sans-serif;
            background: #0F0C29;
            background: -webkit-linear-gradient(to right, #24243E, #302B63, #0F0C29);
            background: linear-gradient(to right, #24243E, #302B63, #0F0C29);
        }

        body.dark-mode .main-container {
            background: rgba(20, 16, 50, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: 12px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        body.dark-mode .main-title {
            font-weight: 700;
            color: #FFFFFF;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
            font-variant: normal;
        }

        body.dark-mode .main-title::after {
            width: 150px;
            background: linear-gradient(to right, transparent, #00FFFF, transparent);
        }

        body.dark-mode .subtitle {
            color: #c0c0e0;
            font-weight: 300;
        }

        body.dark-mode .form-label {
            color: #d0d0f0;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            font-variant: normal;
        }

        body.dark-mode .form-select {
            border-radius: 6px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            background: rgba(30, 25, 70, 0.8);
            color: #FFFFFF;
            font-family: 'Inter', sans-serif;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2300FFFF' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 14px center;
            background-repeat: no-repeat;
            background-size: 16px;
        }

        body.dark-mode .start-button {
            background: linear-gradient(145deg, #00FFFF, #008B8B);
            color: #0F0C29;
            border: none;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
            font-family: 'Inter', sans-serif;
            text-transform: uppercase;
        }
        body.dark-mode .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.6);
            background: linear-gradient(145deg, #00FFFF, #008B8B);
        }

        body.dark-mode .help-text {
            color: #a0a0c0;
        }

        body.dark-mode .footer {
            color: #9090b0;
        }

        body.dark-mode .footer a {
            color: #00FFFF;
        }

        body.dark-mode .disclaimer {
            color: #707090;
        }

        body.dark-mode .back-button {
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #FFFFFF;
            background: rgba(30, 25, 70, 0.8);
            font-family: 'Inter', sans-serif;
            box-shadow: none;
        }
        body.dark-mode .back-button:hover {
            background: rgba(50, 45, 90, 1);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(0);
        }

        body.dark-mode .lectio-header h2 {
            font-weight: 600;
            color: #FFFFFF;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
            font-variant: normal;
        }

        body.dark-mode .lectio-header p {
            color: #c0c0e0;
        }

        body.dark-mode .method-text {
            font-weight: 600;
            color: #FFD700;
        }

        body.dark-mode .resource-category {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .category-title {
            font-weight: 600;
            color: #FFFFFF;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            font-variant: normal;
        }
        body.dark-mode .resource-button {
            font-family: 'Inter', sans-serif;
            border: none;
        }
        body.dark-mode .resource-button:hover {
            transform: scale(1.05);
        }

        body.dark-mode .gospel-library { background: #007bff; }
        body.dark-mode .book-harder   { background: #6f42c1; }
        body.dark-mode .book-online   { background: #17a2b8; }
        body.dark-mode .mynoise       { background: #fd7e14; }
        body.dark-mode .chatgpt       { background: #28a745; }
        body.dark-mode .ldsbot { background: #5b21b6; }
        body.dark-mode .learning-to-love { background: #dc3545; }
        body.dark-mode .seminary-manual { background: #ffc107; color: #212529; }
        body.dark-mode .student-manual { background: #6d4c41; }
        body.dark-mode .book-of-mormon-central { background: #004aad; }
        body.dark-mode .scripture-citation-index { background: #a52a2a; }
        body.dark-mode .tabernacle-choir { background: #DAA520; }
        body.dark-mode .come-follow-me-manual { background: #003366; }
        body.dark-mode .covenant-of-christ { background: #c09551; }
        body.dark-mode .parallel-edition { background: #4682B4; }
        body.dark-mode .plain-english-version { background: #6a5acd; }
        body.dark-mode .gen-z-translate { background: #be185d; }
        body.dark-mode .book-of-mormon-simplified { background: #20B2AA; }
        body.dark-mode .grandpa-dave { background: #B22222; }
        body.dark-mode .generate-questions-ai { background: #1d4ed8; }
        body.dark-mode .museum-of-bom { background: #A0522D; }
        body.dark-mode .book-of-mormon-videos { background: #c53030; }
        body.dark-mode .master-class { background: #E9967A; }
        body.dark-mode .bom-evidence { background: #9b59b6; }
        body.dark-mode .bom-art-catalog { background: #9932CC; }
        body.dark-mode .for-our-day { background: #2980b9; }
        body.dark-mode .teachings-bom { background: #005A9E; }
        body.dark-mode .teachings-bom-2 { background: #006AB1; }
        body.dark-mode .teachings-bom-3 { background: #007BC9; }
        body.dark-mode .teachings-bom-4 { background: #008AE1; }
        body.dark-mode .fair-answers { background: #1abc9c; }
        body.dark-mode .lehi-in-desert { background: #CD853F; }
        body.dark-mode .approach-bom { background: #4169E1; }
        body.dark-mode .since-cumorah { background: #6B8E23; }
        body.dark-mode .prophetic-bom { background: #9370DB; }
        body.dark-mode .byu-speeches { background: #003366; }
        body.dark-mode .general-conference { background: #555555; }


        body.dark-mode .study-section {
            background: rgba(0, 0, 0, 0.25);
            padding: 24px;
            border-radius: 8px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        body.dark-mode .study-section h3 {
            color: #FFFFFF;
            font-weight: 600;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
            font-variant: normal;
        }

        body.dark-mode .lectio-step {
            background: rgba(15, 12, 41, 0.7);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: none;
        }

        body.dark-mode .lectio-step h4 {
            color: #00FFFF;
            font-weight: 600;
            font-variant: normal;
        }

        body.dark-mode .lectio-step p {
            color: #d0d0f0;
            font-weight: 300;
        }

        body.dark-mode .dark-mode-toggle {
            background: rgba(30, 25, 70, 0.8);
            border-color: rgba(255, 255, 255, 0.5);
            color: #FFFFFF;
        }
        body.dark-mode .dark-mode-toggle:hover {
            background: rgba(50, 45, 90, 1);
            color: #FFFFFF;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <div class="main-container">
        <button id="dark-mode-toggle" class="dark-mode-toggle" title="Toggle Dark Mode">🌙</button>
        <div class="selector-page" id="selector-page">
            <header>
                <h1 class="main-title">Lectio Divina Mormonis</h1>
                <p class="subtitle">Mormon's Divine Reading - Book of Mormon study tools</p>
            </header>

            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Book</label>
                    <select id="book-select" class="form-select"></select>
                </div>

                <div class="form-group">
                    <label class="form-label">Chapter</label>
                    <select id="chapter-select" class="form-select"></select>
                </div>
            </div>

            <div style="display: flex; align-items: center; gap: 12px; margin-top: 24px;">
                <button id="start-lectio" class="start-button" onclick="startLectio()">
                    Start Lectio
                </button>
                <small class="help-text">A dedicated Lectio page will open for your selection.</small>
            </div>

            <footer class="footer">
                © 2025 <a href="https://calebday.com" target="_blank" rel="noopener noreferrer">Caleb Day</a>
                <div class="disclaimer">Mormonis is not affiliated with The Church of Jesus Christ of Latter-day Saints.</div>
            </footer>
        </div>

        <div class="lectio-page" id="lectio-page">
            <nav class="nav-bar">
                <button class="back-button" onclick="backToSelector()">
                    ← Back to selector
                </button>
            </nav>

            <header class="lectio-header">
                <h2 id="lectio-title">Chapter — Lectio</h2>
                <p>Use the classic flow: <span class="method-text">Narrative</span> (Literal), <span class="method-text">Allegory</span> (Symbols), <span class="method-text">Reflection</span> (Personal), <span class="method-text">Invitation</span> (Action).</p>
            </header>

            <div class="resources-container" id="resources-container">
                </div>

            <div class="study-section">
                <h3>4 Steps of Lectio Divina</h3>
                <div class="lectio-steps">
                    <div class="lectio-step">
                        <h4>📖 Narrative</h4>
                        <p>Literal meaning: what is happening in the story.</p>
                    </div>
                    <div class="lectio-step">
                        <h4>🔍 Allegory</h4>
                        <p>Metaphors, symbols, or deeper meanings.</p>
                    </div>
                    <div class="lectio-step">
                        <h4>💭 Reflection</h4>
                        <p>What does this text say to me personally right now?</p>
                    </div>
                    <div class="lectio-step">
                        <h4>🎯 Invitation</h4>
                        <p>What action will I take in response to this reading?</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Book of Mormon data
        const BOM_BOOKS = [
            { name: "1 Nephi", slug: "1-ne", chapters: 22 },
            { name: "2 Nephi", slug: "2-ne", chapters: 33 },
            { name: "Jacob", slug: "jacob", chapters: 7 },
            { name: "Enos", slug: "enos", chapters: 1 },
            { name: "Jarom", slug: "jarom", chapters: 1 },
            { name: "Omni", slug: "omni", chapters: 1 },
            { name: "Words of Mormon", slug: "w-of-m", chapters: 1 },
            { name: "Mosiah", slug: "mosiah", chapters: 29 },
            { name: "Alma", slug: "alma", chapters: 63 },
            { name: "Helaman", slug: "hel", chapters: 16 },
            { name: "3 Nephi", slug: "3-ne", chapters: 30 },
            { name: "4 Nephi", slug: "4-ne", chapters: 1 },
            { name: "Mormon", slug: "morm", chapters: 9 },
            { name: "Ether", slug: "ether", chapters: 15 },
            { name: "Moroni", slug: "moro", chapters: 10 }
        ];

        // Covenant of Christ Slug Mappings
        const covenantOfChristSlugMappings = {
            '1-ne': '1nephi',
            '2-ne': '2nephi',
            'jacob': 'jacob',
            'enos': 'enos',
            'jarom': 'jarom',
            'omni': 'omni',
            'w-of-m': 'wordsofmormon',
            'mosiah': 'mosiah',
            'alma': 'alma',
            'hel': 'helaman',
            '3-ne': '3nephi',
            '4-ne': '4nephi',
            'morm': 'mormon',
            'ether': 'ether',
            'moro': 'moroni'
        };

        // Lesson to PDF page mapping
        const LESSON_PAGES = [
            { range: [{ slug: "1-ne", chapters: [1,2,3,4,5,6,7] }], page: 28 },
            { range: [{ slug: "1-ne", chapters: [8,9,10,11,12,15] }], page: 36 },
            { range: [{ slug: "1-ne", chapters: [12,13,14] }], page: 44 },
            { range: [{ slug: "1-ne", chapters: [16,17,18,19,20,21,22] }], page: 52 },
            { range: [{ slug: "2-ne", chapters: [1,2] }], page: 60 },
            { range: [{ slug: "2-ne", chapters: [3,4,5] }], page: 70 },
            { range: [{ slug: "2-ne", chapters: [6,7,8,9,10] }], page: 76 },
            { range: [{ slug: "2-ne", chapters: Array.from({length:15}, (_,i)=>i+11) }], page: 90 },
            { range: [{ slug: "2-ne", chapters: [26,27,28,29,30] }], page: 100 },
            { range: [{ slug: "2-ne", chapters: [31,32,33] }], page: 108 },
            { range: [{ slug: "jacob", chapters: [1,2,3,4] }], page: 114 },
            { range: [{ slug: "jacob", chapters: [5,6,7] }], page: 122 },
            { range: [{ slug: "enos", chapters: [1]}, {slug:"jarom", chapters:[1]}, {slug:"omni", chapters:[1]}, {slug:"w-of-m", chapters:[1]}], page: 130 },
            { range: [{ slug: "mosiah", chapters: [1,2,3] }], page: 136 },
            { range: [{ slug: "mosiah", chapters: [4,5,6] }], page: 146 },
            { range: [{ slug: "mosiah", chapters: [7,8,9,10,11] }], page: 160 },
            { range: [{ slug: "mosiah", chapters: [12,13,14,15,16,17] }], page: 164 },
            { range: [{ slug: "mosiah", chapters: [18,19,20,21,22,23,24] }], page: 176 },
            { range: [{ slug: "mosiah", chapters: [25,26,27,28]}, {slug: "alma", chapters: [36]}], page: 180 },
            { range: [{ slug: "mosiah", chapters: [29]}, {slug:"alma", chapters:[1,2,3,4]}], page: 190 },
            { range: [{ slug: "alma", chapters: [5,6,7] }], page: 196 },
            { range: [{ slug: "alma", chapters: [8,9,10,11,12] }], page: 204 },
            { range: [{ slug: "alma", chapters: [13,14,15,16] }], page: 212 },
            { range: [{ slug: "alma", chapters: [17,18,19,20,21,22] }], page: 218 },
            { range: [{ slug: "alma", chapters: [23,24,25,26,27,28,29] }], page: 224 },
            { range: [{ slug: "alma", chapters: [30,31] }], page: 230 },
            { range: [{ slug: "alma", chapters: [32,33,34,35] }], page: 236 },
            { range: [{ slug: "alma", chapters: [36,37,38,39] }], page: 250 },
            { range: [{ slug: "alma", chapters: [40,41,42] }], page: 256 },
            { range: [{ slug: "alma", chapters: [43,44,45,46,47,48,49,50,51,52] }], page: 262 },
            { range: [{ slug: "alma", chapters: [53,54,55,56,57,58,59,60,61,62,63] }], page: 266 },
            { range: [{ slug: "hel", chapters: [1,2,3,4,5] }], page: 270 },
            { range: [{ slug: "hel", chapters: [6,7,8,9,10,11,12] }], page: 278 },
            { range: [{ slug: "hel", chapters: [13,14,15,16] }], page: 288 },
            { range: [{ slug: "3-ne", chapters: [1,2,3,4,5,6,7] }], page: 294 },
            { range: [{ slug: "3-ne", chapters: [8,9,10,11] }], page: 298 },
            { range: [{ slug: "3-ne", chapters: [12,13,14,15] }], page: 304 },
            { range: [{ slug: "3-ne", chapters: [17,18,19] }], page: 318 },
            { range: [{ slug: "3-ne", chapters: [16,20,21] }], page: 324 },
            { range: [{ slug: "3-ne", chapters: [22,23,24,25,26] }], page: 328 },
            { range: [{ slug: "3-ne", chapters: [27,28,29,30]}, {slug:"4-ne", chapters:[1]}], page: 332 },
            { range: [{ slug: "morm", chapters: [1,2,3,4,5,6]}, {slug:"moro", chapters:[9]}], page: 338 },
            { range: [{ slug: "morm", chapters: [7,8,9] }], page: 344 },
            { range: [{ slug: "ether", chapters: [1,2,3,4,5,6] }], page: 350 },
            { range: [{ slug: "ether", chapters: [7,8,9,10,11,12,13,14,15] }], page: 356 },
            { range: [{ slug: "moro", chapters: [1,2,3,4,5,6] }], page: 360 },
            { range: [{ slug: "moro", chapters: [7,8,10] }], page: 364 }
        ];

        const studentManualMappings = [
            { range: [{ slug: "1-ne", chapters: [1, 2, 3, 4, 5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-2-1-nephi-1-5?lang=eng" },
            { range: [{ slug: "1-ne", chapters: [6, 7, 8, 9, 10, 11] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-3-1-nephi-6-11?lang=eng" },
            { range: [{ slug: "1-ne", chapters: [12, 13, 14, 15] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-4-1-nephi-12-15?lang=eng" },
            { range: [{ slug: "1-ne", chapters: [16, 17, 18] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-5-1-nephi-16-18?lang=eng" },
            { range: [{ slug: "1-ne", chapters: [19, 20, 21, 22] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-6-1-nephi-19-22?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [1, 2, 3] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-7-2-nephi-1-3?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [4, 5, 6, 7, 8] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-8-2-nephi-4-8?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [9, 10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-9-2-nephi-9-10?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [11, 12, 13, 14, 15, 16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-10-2-nephi-11-16?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [17, 18, 19, 20, 21, 22, 23, 24] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-11-2-nephi-17-24?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [25, 26, 27] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-12-2-nephi-25-27?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [28, 29, 30] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-13-2-nephi-28-30?lang=eng" },
            { range: [{ slug: "2-ne", chapters: [31, 32, 33] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-14-2-nephi-31-33?lang=eng" },
            { range: [{ slug: "jacob", chapters: [1, 2, 3, 4] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-15-jacob-1-4?lang=eng" },
            { range: [{ slug: "jacob", chapters: [5, 6, 7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-16-jacob-5-7?lang=eng" },
            { range: [{ slug: "enos", chapters: [1] }, { slug: "jarom", chapters: [1] }, { slug: "omni", chapters: [1] }, { slug: "w-of-m", chapters: [1] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-17-enos-words-of-mormon?lang=eng" },
            { range: [{ slug: "mosiah", chapters: [1, 2, 3] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-18-mosiah-1-3?lang=eng" },
            { range: [{ slug: "mosiah", chapters: [4, 5, 6, 7, 8] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-19-mosiah-4-8?lang=eng" },
            { range: [{ slug: "mosiah", chapters: [9, 10, 11, 12, 13, 14, 15, 16, 17] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-20-mosiah-9-17?lang=eng" },
            { range: [{ slug: "mosiah", chapters: [18, 19, 20, 21, 22, 23, 24] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-21-mosiah-18-24?lang=eng" },
            { range: [{ slug: "mosiah", chapters: [25, 26, 27, 28, 29] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-22-mosiah-25-29?lang=eng" },
            { range: [{ slug: "alma", chapters: [1, 2, 3, 4] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-23-alma-1-4?lang=eng" },
            { range: [{ slug: "alma", chapters: [5, 6, 7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-24-alma-5-7?lang=eng" },
            { range: [{ slug: "alma", chapters: [8, 9, 10, 11, 12] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-25-alma-8-12?lang=eng" },
            { range: [{ slug: "alma", chapters: [13, 14, 15, 16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-26-alma-13-16?lang=eng" },
            { range: [{ slug: "alma", chapters: [17, 18, 19, 20, 21, 22] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-27-alma-17-22?lang=eng" },
            { range: [{ slug: "alma", chapters: [23, 24, 25, 26, 27, 28, 29] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-28-alma-23-29?lang=eng" },
            { range: [{ slug: "alma", chapters: [30, 31] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-29-alma-30-31?lang=eng" },
            { range: [{ slug: "alma", chapters: [32, 33, 34, 35] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-30-alma-32-35?lang=eng" },
            { range: [{ slug: "alma", chapters: [36, 37, 38, 39] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-31-alma-36-39?lang=eng" },
            { range: [{ slug: "alma", chapters: [40, 41, 42] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-32-alma-40-42?lang=eng" },
            { range: [{ slug: "alma", chapters: [43, 44, 45, 46, 47, 48, 49, 50, 51] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-33-alma-43-51?lang=eng" },
            { range: [{ slug: "alma", chapters: [52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-34-alma-52-63?lang=eng" },
            { range: [{ slug: "hel", chapters: [1, 2, 3, 4] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-35-helaman-1-4?lang=eng" },
            { range: [{ slug: "hel", chapters: [5, 6, 7, 8, 9] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-36-helaman-5-9?lang=eng" },
            { range: [{ slug: "hel", chapters: [10, 11, 12] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-37-helaman-10-12?lang=eng" },
            { range: [{ slug: "hel", chapters: [13, 14, 15, 16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-38-helaman-13-16?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [1, 2, 3, 4, 5, 6, 7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-39-3-nephi-1-7?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [8, 9, 10, 11] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-40-3-nephi-8-11?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [12, 13, 14] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-41-3-nephi-12-14?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [15, 16, 17] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-42-3-nephi-15-17?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [18, 19] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-43-3-nephi-18-19?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [20, 21, 22] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-44-3-nephi-20-22?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [23, 24, 25, 26] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-45-3-nephi-23-26?lang=eng" },
            { range: [{ slug: "3-ne", chapters: [27, 28, 29, 30] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-46-3-nephi-27-30?lang=eng" },
            { range: [{ slug: "4-ne", chapters: [1] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-47-4-nephi?lang=eng" },
            { range: [{ slug: "morm", chapters: [1, 2, 3, 4, 5, 6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-48-mormon-1-6?lang=eng" },
            { range: [{ slug: "morm", chapters: [7, 8, 9] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-49-mormon-7-9?lang=eng" },
            { range: [{ slug: "ether", chapters: [1, 2, 3, 4, 5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-50-ether-1-5?lang=eng" },
            { range: [{ slug: "ether", chapters: [6, 7, 8, 9, 10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-51-ether-6-10?lang=eng" },
            { range: [{ slug: "ether", chapters: [11, 12, 13, 14, 15] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-52-ether-11-15?lang=eng" },
            { range: [{ slug: "moro", chapters: [1, 2, 3, 4, 5, 6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-53-moroni-1-6?lang=eng" },
            { range: [{ slug: "moro", chapters: [7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-54-moroni-7?lang=eng" },
            { range: [{ slug: "moro", chapters: [8, 9] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-55-moroni-8-9?lang=eng" },
            { range: [{ slug: "moro", chapters: [10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-student-manual/chapter-56-moroni-10?lang=eng" }
        ];

        const bookOfMormonCentralMappings = [
            { range: [{ slug: "1-ne", chapters: [1, 2, 3, 4, 5] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/1-nephi-1-5?pId=36&sId=101" },
            { range: [{ slug: "1-ne", chapters: [6, 7, 8, 9, 10] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/1-nephi-6-10?pId=36&sId=102" },
            { range: [{ slug: "1-ne", chapters: [11, 12, 13, 14, 15] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/1-nephi-11-15?pId=36&sId=103" },
            { range: [{ slug: "1-ne", chapters: [16, 17, 18, 19, 20, 21, 22] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/1-nephi-16-22?pId=36&sId=104" },
            { range: [{ slug: "2-ne", chapters: [1, 2] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/2-nephi-1-2?pId=36&sId=105" },
            { range: [{ slug: "2-ne", chapters: [3, 4, 5] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/2-nephi-3-5?pId=36&sId=106" },
            { range: [{ slug: "2-ne", chapters: [6, 7, 8, 9, 10] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/2-nephi-6-10?pId=36&sId=107" },
            { range: [{ slug: "2-ne", chapters: [11, 12, 13, 14, 15, 16, 17, 18, 19] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/2-nephi-11-19?pId=36&sId=108" },
            { range: [{ slug: "2-ne", chapters: [20, 21, 22, 23, 24, 25] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/2-nephi-20-25?pId=36&sId=109" },
            { range: [{ slug: "2-ne", chapters: [26, 27, 28, 29, 30] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/2-nephi-26-30?pId=36&sId=110" },
            { range: [{ slug: "2-ne", chapters: [31, 32, 33] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/2-nephi-31-33?pId=36&sId=111" },
            { range: [{ slug: "jacob", chapters: [1, 2, 3, 4] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/jacob-1-4?pId=36&sId=113" },
            { range: [{ slug: "jacob", chapters: [5, 6, 7] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/jacob-5-7?pId=36&sId=114" },
            { range: [{ slug: "enos", chapters: [1] }, { slug: "jarom", chapters: [1] }, { slug: "omni", chapters: [1] }, { slug: "w-of-m", chapters: [1] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/enos-words-of-mormon?pId=36&sId=115" },
            { range: [{ slug: "mosiah", chapters: [1, 2, 3] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mosiah-1-3?pId=36&sId=116" },
            { range: [{ slug: "mosiah", chapters: [4, 5, 6] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mosiah-4-6?pId=36&sId=117" },
            { range: [{ slug: "mosiah", chapters: [7, 8, 9, 10] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mosiah-7-10?pId=36&sId=118" },
            { range: [{ slug: "mosiah", chapters: [11, 12, 13, 14, 15, 16, 17] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mosiah-11-17?pId=36&sId=119" },
            { range: [{ slug: "mosiah", chapters: [18, 19, 20, 21, 22, 23, 24] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mosiah-18-24?pId=36&sId=120" },
            { range: [{ slug: "mosiah", chapters: [25, 26, 27, 28] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mosiah-25-28?pId=36&sId=121" },
            { range: [{ slug: "mosiah", chapters: [29] }, { slug: "alma", chapters: [1, 2, 3, 4] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mosiah-29-alma-4?pId=36&sId=122" },
            { range: [{ slug: "alma", chapters: [5, 6, 7] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-5-7?pId=36&sId=123" },
            { range: [{ slug: "alma", chapters: [8, 9, 10, 11, 12] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-8-12?pId=36&sId=124" },
            { range: [{ slug: "alma", chapters: [13, 14, 15, 16] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-13-16?pId=36&sId=125" },
            { range: [{ slug: "alma", chapters: [17, 18, 19, 20, 21, 22] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-17-22?pId=36&sId=126" },
            { range: [{ slug: "alma", chapters: [23, 24, 25, 26, 27, 28, 29] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-23-29?pId=36&sId=127" },
            { range: [{ slug: "alma", chapters: [30, 31] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-30-31?pId=36&sId=128" },
            { range: [{ slug: "alma", chapters: [32, 33, 34, 35] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-32-35?pId=36&sId=129" },
            { range: [{ slug: "alma", chapters: [36, 37, 38] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-36-38?pId=36&sId=130" },
            { range: [{ slug: "alma", chapters: [39, 40, 41, 42] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-39-42?pId=36&sId=131" },
            { range: [{ slug: "alma", chapters: [43, 44, 45, 46, 47, 48, 49, 50, 51, 52] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-43-52?pId=36&sId=132" },
            { range: [{ slug: "alma", chapters: [53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/alma-53-63?pId=36&sId=133" },
            { range: [{ slug: "hel", chapters: [1, 2, 3, 4, 5, 6] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/helaman-1-6?pId=36&sId=134" },
            { range: [{ slug: "hel", chapters: [7, 8, 9, 10, 11, 12] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/helaman-7-12?pId=36&sId=135" },
            { range: [{ slug: "hel", chapters: [13, 14, 15, 16] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/helaman-13-16?pId=36&sId=136" },
            { range: [{ slug: "3-ne", chapters: [1, 2, 3, 4, 5, 6, 7] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/3-nephi-1-7?pId=36&sId=137" },
            { range: [{ slug: "3-ne", chapters: [8, 9, 10, 11] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/3-nephi-8-11?pId=36&sId=138" },
            { range: [{ slug: "3-ne", chapters: [12, 13, 14, 15, 16] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/3-nephi-12-16?pId=36&sId=139" },
            { range: [{ slug: "3-ne", chapters: [17, 18, 19] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/3-nephi-17-19?pId=36&sId=140" },
            { range: [{ slug: "3-ne", chapters: [20, 21, 22, 23, 24, 25, 26] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/3-nephi-20-26?pId=36&sId=141" },
            { range: [{ slug: "3-ne", chapters: [27, 28, 29, 30] }, { slug: "4-ne", chapters: [1] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/3-nephi-27-4-nephi?pId=36&sId=142" },
            { range: [{ slug: "morm", chapters: [1, 2, 3, 4, 5, 6] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mormon-1-6?pId=36&sId=143" },
            { range: [{ slug: "morm", chapters: [7, 8, 9] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/mormon-7-9?pId=36&sId=144" },
            { range: [{ slug: "ether", chapters: [1, 2, 3, 4, 5] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/ether-1-5?pId=36&sId=145" },
            { range: [{ slug: "ether", chapters: [6, 7, 8, 9, 10, 11] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/ether-6-11?pId=36&sId=146" },
            { range: [{ slug: "ether", chapters: [12, 13, 14, 15] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/ether-12-15?pId=36&sId=147" },
            { range: [{ slug: "moro", chapters: [1, 2, 3, 4, 5, 6] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/moroni-1-6?pId=36&sId=148" },
            { range: [{ slug: "moro", chapters: [7, 8, 9] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/moroni-7-9?pId=36&sId=149" },
            { range: [{ slug: "moro", chapters: [10] }], url: "https://scripturecentral.org/come-follow-me/book-of-mormon-2024/moroni-10?pId=36&sId=150" }
        ];

        const comeFollowMeManualMappings = [
            { lesson: 2, range: [{ slug: "1-ne", chapters: [1, 2, 3, 4, 5] }] },
            { lesson: 3, range: [{ slug: "1-ne", chapters: [6, 7, 8, 9, 10] }] },
            { lesson: 4, range: [{ slug: "1-ne", chapters: [11, 12, 13, 14, 15] }] },
            { lesson: 5, range: [{ slug: "1-ne", chapters: [16, 17, 18, 19, 20, 21, 22] }] },
            { lesson: 6, range: [{ slug: "2-ne", chapters: [1, 2] }] },
            { lesson: 7, range: [{ slug: "2-ne", chapters: [3, 4, 5] }] },
            { lesson: 8, range: [{ slug: "2-ne", chapters: [6, 7, 8, 9, 10] }] },
            { lesson: 9, range: [{ slug: "2-ne", chapters: [11, 12, 13, 14, 15, 16, 17, 18, 19] }] },
            { lesson: 10, range: [{ slug: "2-ne", chapters: [20, 21, 22, 23, 24, 25] }] },
            { lesson: 11, range: [{ slug: "2-ne", chapters: [26, 27, 28, 29, 30] }] },
            { lesson: 12, range: [{ slug: "2-ne", chapters: [31, 32, 33] }] },
            { lesson: 14, range: [{ slug: "jacob", chapters: [1, 2, 3, 4] }] },
            { lesson: 15, range: [{ slug: "jacob", chapters: [5, 6, 7] }] },
            { lesson: 16, range: [{ slug: "enos", chapters: [1] }, { slug: "jarom", chapters: [1] }, { slug: "omni", chapters: [1] }, { slug: "w-of-m", chapters: [1] }] },
            { lesson: 17, range: [{ slug: "mosiah", chapters: [1, 2, 3] }] },
            { lesson: 18, range: [{ slug: "mosiah", chapters: [4, 5, 6] }] },
            { lesson: 19, range: [{ slug: "mosiah", chapters: [7, 8, 9, 10] }] },
            { lesson: 20, range: [{ slug: "mosiah", chapters: [11, 12, 13, 14, 15, 16, 17] }] },
            { lesson: 21, range: [{ slug: "mosiah", chapters: [18, 19, 20, 21, 22, 23, 24] }] },
            { lesson: 22, range: [{ slug: "mosiah", chapters: [25, 26, 27, 28] }] },
            { lesson: 23, range: [{ slug: "mosiah", chapters: [29] }, { slug: "alma", chapters: [1, 2, 3, 4] }] },
            { lesson: 24, range: [{ slug: "alma", chapters: [5, 6, 7] }] },
            { lesson: 25, range: [{ slug: "alma", chapters: [8, 9, 10, 11, 12] }] },
            { lesson: 26, range: [{ slug: "alma", chapters: [13, 14, 15, 16] }] },
            { lesson: 27, range: [{ slug: "alma", chapters: [17, 18, 19, 20, 21, 22] }] },
            { lesson: 28, range: [{ slug: "alma", chapters: [23, 24, 25, 26, 27, 28, 29] }] },
            { lesson: 29, range: [{ slug: "alma", chapters: [30, 31] }] },
            { lesson: 30, range: [{ slug: "alma", chapters: [32, 33, 34, 35] }] },
            { lesson: 31, range: [{ slug: "alma", chapters: [36, 37, 38] }] },
            { lesson: 32, range: [{ slug: "alma", chapters: [39, 40, 41, 42] }] },
            { lesson: 33, range: [{ slug: "alma", chapters: [43, 44, 45, 46, 47, 48, 49, 50, 51, 52] }] },
            { lesson: 34, range: [{ slug: "alma", chapters: [53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63] }] },
            { lesson: 35, range: [{ slug: "hel", chapters: [1, 2, 3, 4, 5, 6] }] },
            { lesson: 36, range: [{ slug: "hel", chapters: [7, 8, 9, 10, 11, 12] }] },
            { lesson: 37, range: [{ slug: "hel", chapters: [13, 14, 15, 16] }] },
            { lesson: 38, range: [{ slug: "3-ne", chapters: [1, 2, 3, 4, 5, 6, 7] }] },
            { lesson: 39, range: [{ slug: "3-ne", chapters: [8, 9, 10, 11] }] },
            { lesson: 40, range: [{ slug: "3-ne", chapters: [12, 13, 14, 15, 16] }] },
            { lesson: 41, range: [{ slug: "3-ne", chapters: [17, 18, 19] }] },
            { lesson: 42, range: [{ slug: "3-ne", chapters: [20, 21, 22, 23, 24, 25, 26] }] },
            { lesson: 43, range: [{ slug: "3-ne", chapters: [27, 28, 29, 30] }, { slug: "4-ne", chapters: [1] }] },
            { lesson: 44, range: [{ slug: "morm", chapters: [1, 2, 3, 4, 5, 6] }] },
            { lesson: 45, range: [{ slug: "morm", chapters: [7, 8, 9] }] },
            { lesson: 46, range: [{ slug: "ether", chapters: [1, 2, 3, 4, 5] }] },
            { lesson: 47, range: [{ slug: "ether", chapters: [6, 7, 8, 9, 10, 11] }] },
            { lesson: 48, range: [{ slug: "ether", chapters: [12, 13, 14, 15] }] },
            { lesson: 49, range: [{ slug: "moro", chapters: [1, 2, 3, 4, 5, 6] }] },
            { lesson: 50, range: [{ slug: "moro", chapters: [7, 8, 9] }] },
            { lesson: 51, range: [{ slug: "moro", chapters: [10] }] }
        ];

        const bookOfMormonVideoMappings = [
            { url: "https://www.churchofjesuschrist.org/media/collection/1-nephi-1-2?lang=eng", range: [{ slug: "1-ne", chapters: [1, 2] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/1-nephi-3-5?lang=eng", range: [{ slug: "1-ne", chapters: [3, 4, 5] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/1-nephi-7?lang=eng", range: [{ slug: "1-ne", chapters: [7] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/1-nephi-8?lang=eng", range: [{ slug: "1-ne", chapters: [8] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/1-nephi-10-15?lang=eng", range: [{ slug: "1-ne", chapters: [10, 11, 12, 13, 14, 15] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/1-nephi-16?lang=eng", range: [{ slug: "1-ne", chapters: [16] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/1-nephi-17-18?lang=eng", range: [{ slug: "1-ne", chapters: [17, 18] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/2-nephi-1-4?lang=eng", range: [{ slug: "2-ne", chapters: [1, 2, 3, 4] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/2-nephi-5?lang=eng", range: [{ slug: "2-ne", chapters: [5] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/2-nephi-6-10?lang=eng", range: [{ slug: "2-ne", chapters: [6, 7, 8, 9, 10] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/2-nephi-31-32?lang=eng", range: [{ slug: "2-ne", chapters: [31, 32] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/2-nephi-33?lang=eng", range: [{ slug: "2-ne", chapters: [33] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/jacob-2-3?lang=eng", range: [{ slug: "jacob", chapters: [2, 3] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/jacob-5?lang=eng", range: [{ slug: "jacob", chapters: [5] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/jacob-7?lang=eng", range: [{ slug: "jacob", chapters: [7] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/enos-1?lang=eng", range: [{ slug: "enos", chapters: [1] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/mosiah-1-5?lang=eng", range: [{ slug: "mosiah", chapters: [1, 2, 3, 4, 5] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/mosiah-11-18?lang=eng", range: [{ slug: "mosiah", chapters: [11, 12, 13, 14, 15, 16, 17, 18] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/mosiah-21-24?lang=eng", range: [{ slug: "mosiah", chapters: [21, 22, 23, 24] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/mosiah-27-alma-36?lang=eng", range: [{ slug: "mosiah", chapters: [27] }, { slug: "alma", chapters: [36] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-4-7?lang=eng", range: [{ slug: "alma", chapters: [4, 5, 6, 7] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-8-15?lang=eng", range: [{ slug: "alma", chapters: [8, 9, 10, 11, 12, 13, 14, 15] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-17-19?lang=eng", range: [{ slug: "alma", chapters: [17, 18, 19] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-23-27?lang=eng", range: [{ slug: "alma", chapters: [23, 24, 25, 26, 27] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-31-34?lang=eng", range: [{ slug: "alma", chapters: [31, 32, 33, 34] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-36-42?lang=eng", range: [{ slug: "alma", chapters: [36, 37, 38, 39, 40, 41, 42] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-46?lang=eng", range: [{ slug: "alma", chapters: [46] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/alma-53-58?lang=eng", range: [{ slug: "alma", chapters: [53, 54, 55, 56, 57, 58] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/helaman-5?lang=eng", range: [{ slug: "hel", chapters: [5] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/helaman-13-16-3-nephi-1?lang=eng", range: [{ slug: "hel", chapters: [13, 14, 15, 16] }, {slug: "3-ne", chapters: [1]}] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-8-11?lang=eng", range: [{ slug: "3-ne", chapters: [8, 9, 10, 11] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-11-12?lang=eng", range: [{ slug: "3-ne", chapters: [11, 12] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-12-14?lang=eng", range: [{ slug: "3-ne", chapters: [12, 13, 14] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-15-16?lang=eng", range: [{ slug: "3-ne", chapters: [15, 16] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-17?lang=eng", range: [{ slug: "3-ne", chapters: [17] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-18?lang=eng", range: [{ slug: "3-ne", chapters: [18] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-19?lang=eng", range: [{ slug: "3-ne", chapters: [19] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-20-23?lang=eng", range: [{ slug: "3-ne", chapters: [20, 21, 22, 23] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/3-nephi-27?lang=eng", range: [{ slug: "3-ne", chapters: [27] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/mormon-1-7?lang=eng", range: [{ slug: "morm", chapters: [1, 2, 3, 4, 5, 6, 7] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/ether-1-6-12-13?lang=eng", range: [{ slug: "ether", chapters: [1, 2, 3, 4, 5, 6, 12, 13] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/mormon-8-9-moroni-1-10-title-page?lang=eng", range: [{ slug: "morm", chapters: [8, 9] }, { slug: "moro", chapters: [1, 10] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/moroni-7?lang=eng", range: [{ slug: "moro", chapters: [7] }] },
            { url: "https://www.churchofjesuschrist.org/media/collection/moroni-8?lang=eng", range: [{ slug: "moro", chapters: [8] }] }
        ];

        // DOM elements
        const selectorPage = document.getElementById('selector-page');
        const lectioPage = document.getElementById('lectio-page');
        const bookSelect = document.getElementById('book-select');
        const chapterSelect = document.getElementById('chapter-select');
        const lectioTitle = document.getElementById('lectio-title');
        const resourcesContainer = document.getElementById('resources-container');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const body = document.body;

        // --- Dark Mode Logic ---
        function setDarkMode(isDark) {
            if (isDark) {
                body.classList.add('dark-mode');
                darkModeToggle.textContent = '☀️';
                localStorage.setItem('darkMode', 'enabled');
            } else {
                body.classList.remove('dark-mode');
                darkModeToggle.textContent = '🌙';
                localStorage.setItem('darkMode', 'disabled');
            }
        }
        // --- End Dark Mode Logic ---


        // Utility functions
        function findLessonPage(slug, chapter) {
            for (const lesson of LESSON_PAGES) {
                for (const entry of lesson.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) {
                        return lesson.page;
                    }
                }
            }
            return null;
        }

        function findSeminaryManualUrl(slug, chapter) {
            // Seminary Student Manual 2024 chapter groupings
            const seminaryMappings = [
                { range: [{ slug: "1-ne", chapters: [1,2,3,4,5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/03-1-nephi-1-5/031-student?lang=eng" },
                { range: [{ slug: "1-ne", chapters: [6,7,8,9,10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/04-1-nephi-6-10/041-student?lang=eng" },
                { range: [{ slug: "1-ne", chapters: [11,12,13,14,15] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/05-1-nephi-11-15/051-student?lang=eng" },
                { range: [{ slug: "1-ne", chapters: [16,17,18,19,20,21,22] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/06-1-nephi-16-22/061-student?lang=eng" },
                { range: [{ slug: "2-ne", chapters: [1,2] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/07-2-nephi-1-2/071-student?lang=eng" },
                { range: [{ slug: "2-ne", chapters: [3,4,5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/08-2-nephi-3-5/081-student?lang=eng" },
                { range: [{ slug: "2-ne", chapters: [6,7,8,9,10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/09-2-nephi-6-10/091-student?lang=eng" },
                { range: [{ slug: "2-ne", chapters: [11,12,13,14,15,16,17,18,19] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/10-2-nephi-11-19/101-student?lang=eng" },
                { range: [{ slug: "2-ne", chapters: [20,21,22,23,24,25] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/11-2-nephi-20-25/111-student?lang=eng" },
                { range: [{ slug: "2-ne", chapters: [26,27,28,29,30] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/12-2-nephi-26-30/121-student?lang=eng" },
                { range: [{ slug: "2-ne", chapters: [31,32,33] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/13-2-nephi-31-33/131-student?lang=eng" },
                { range: [{ slug: "jacob", chapters: [1,2,3,4] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/14-jacob-1-4/141-student?lang=eng" },
                { range: [{ slug: "jacob", chapters: [5,6,7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/15-jacob-5-7/151-student?lang=eng" },
                { range: [{ slug: "enos", chapters: [1] }, { slug: "jarom", chapters: [1] }, { slug: "omni", chapters: [1] }, { slug: "w-of-m", chapters: [1] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/16-enos-words-of-mormon/161-student?lang=eng" },
                { range: [{ slug: "mosiah", chapters: [1,2,3] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/17-mosiah-1-3/171-student?lang=eng" },
                { range: [{ slug: "mosiah", chapters: [4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/18-mosiah-4-6/181-student?lang=eng" },
                { range: [{ slug: "mosiah", chapters: [7,8,9,10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/19-mosiah-7-10/191-student?lang=eng" },
                { range: [{ slug: "mosiah", chapters: [11,12,13,14,15,16,17] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/20-mosiah-11-17/201-student?lang=eng" },
                { range: [{ slug: "mosiah", chapters: [18,19,20,21,22,23,24] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/21-mosiah-18-24/211-student?lang=eng" },
                { range: [{ slug: "mosiah", chapters: [25,26,27,28] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/22-mosiah-25-28/221-student?lang=eng" },
                { range: [{ slug: "mosiah", chapters: [29] }, { slug: "alma", chapters: [1,2,3,4] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/23-mosiah-29-alma-4/231-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [5,6,7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/24-alma-5-7/241-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [8,9,10,11,12] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/25-alma-8-12/251-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [13,14,15,16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/26-alma-13-16/261-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [17,18,19,20,21,22] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/27-alma-17-22/271-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [23,24,25,26,27,28,29] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/28-alma-23-29/281-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [30,31] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/29-alma-30-31/291-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [32,33,34,35] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/30-alma-32-35/301-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [36,37,38] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/31-alma-36-38/311-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [39,40,41,42] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/32-alma-39-42/321-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [43,44,45,46,47,48,49,50,51,52] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/33-alma-43-52/331-student?lang=eng" },
                { range: [{ slug: "alma", chapters: [53,54,55,56,57,58,59,60,61,62,63] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/34-alma-53-63/341-student?lang=eng" },
                { range: [{ slug: "hel", chapters: [1,2,3,4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/35-helaman-1-6/351-student?lang=eng" },
                { range: [{ slug: "hel", chapters: [7,8,9,10,11,12] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/36-helaman-7-12/361-student?lang=eng" },
                { range: [{ slug: "hel", chapters: [13,14,15,16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/37-helaman-13-16/371-student?lang=eng" },
                { range: [{ slug: "3-ne", chapters: [1,2,3,4,5,6,7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/38-3-nephi-1-7/381-student?lang=eng" },
                { range: [{ slug: "3-ne", chapters: [8,9,10,11] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/39-3-nephi-8-11/391-student?lang=eng" },
                { range: [{ slug: "3-ne", chapters: [12,13,14,15,16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/40-3-nephi-12-16/401-student?lang=eng" },
                { range: [{ slug: "3-ne", chapters: [17,18,19] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/41-3-nephi-17-19/411-student?lang=eng" },
                { range: [{ slug: "3-ne", chapters: [20,21,22,23,24,25,26] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/42-3-nephi-20-26/421-student?lang=eng" },
                { range: [{ slug: "3-ne", chapters: [27,28,29,30] }, { slug: "4-ne", chapters: [1] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/43-3-nephi-27-4-nephi-1/431-student?lang=eng" },
                { range: [{ slug: "morm", chapters: [1,2,3,4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/44-mormon-1-6/441-student?lang=eng" },
                { range: [{ slug: "morm", chapters: [7,8,9] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/45-mormon-7-9/451-student?lang=eng" },
                { range: [{ slug: "ether", chapters: [1,2,3,4,5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/46-ether-1-5/461-student?lang=eng" },
                { range: [{ slug: "ether", chapters: [6,7,8,9,10,11] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/47-ether-6-11/471-student?lang=eng" },
                { range: [{ slug: "ether", chapters: [12,13,14,15] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/48-ether-12-15/481-student?lang=eng" },
                { range: [{ slug: "moro", chapters: [1,2,3,4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/49-moroni-1-6/491-student?lang=eng" },
                { range: [{ slug: "moro", chapters: [7,8,9] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/50-moroni-7-9/501-student?lang=eng" },
                { range: [{ slug: "moro", chapters: [10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/51-moroni-10/511-student?lang=eng" }
            ];

            for (const mapping of seminaryMappings) {
                for (const entry of mapping.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) {
                        return mapping.url;
                    }
                }
            }
            return null;
        }

        function findStudentManualUrl(slug, chapter) {
            for (const mapping of studentManualMappings) {
                for (const entry of mapping.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) {
                        return mapping.url;
                    }
                }
            }
            return null;
        }

        function findBookOfMormonCentralUrl(slug, chapter) {
            for (const mapping of bookOfMormonCentralMappings) {
                for (const entry of mapping.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) {
                        return mapping.url;
                    }
                }
            }
            return null;
        }
        
        function findComeFollowMeManualUrl(slug, chapter) {
            for (const mapping of comeFollowMeManualMappings) {
                for (const entry of mapping.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) {
                        const lessonNumber = String(mapping.lesson).padStart(2, '0');
                        return `https://www.churchofjesuschrist.org/study/manual/come-follow-me-for-home-and-church-book-of-mormon-2024/${lessonNumber}?lang=eng`;
                    }
                }
            }
            return null;
        }

        function findBookOfMormonVideoUrl(slug, chapter) {
            const defaultUrl = "https://www.churchofjesuschrist.org/media/collection/book-of-mormon-videos?lang=eng";
            for (const mapping of bookOfMormonVideoMappings) {
                for (const entry of mapping.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) {
                        return mapping.url;
                    }
                }
            }
            return defaultUrl;
        }

        function createResourceCategory(title, buttons) {
            if (buttons.filter(Boolean).length === 0) return null;
            
            const category = document.createElement('div');
            category.className = 'resource-category';
            
            const categoryTitle = document.createElement('h3');
            categoryTitle.className = 'category-title';
            categoryTitle.textContent = title;
            
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'category-buttons';
            
            buttons.forEach(button => {
                if (button) buttonContainer.appendChild(button);
            });
            
            category.appendChild(categoryTitle);
            category.appendChild(buttonContainer);
            
            return category;
        }

        function createButton(text, url, className) {
            const button = document.createElement('a');
            button.href = url;
            button.target = '_blank';
            button.rel = 'noopener noreferrer';
            button.className = `resource-button ${className}`;
            button.textContent = text;
            return button;
        }

        // Initialize app
        function init() {
            // Check for saved dark mode preference on init
            if (localStorage.getItem('darkMode') === 'enabled') {
                setDarkMode(true);
            }
            populateBooks();
            setupEventListeners();
            handleRouting();
        }

        function populateBooks() {
            BOM_BOOKS.forEach(book => {
                const option = document.createElement('option');
                option.value = book.slug;
                option.textContent = book.name;
                bookSelect.appendChild(option);
            });
            handleBookChange();
        }

        function setupEventListeners() {
            bookSelect.addEventListener('change', handleBookChange);
            window.addEventListener('hashchange', handleRouting);
            darkModeToggle.addEventListener('click', () => {
                const isDarkMode = body.classList.contains('dark-mode');
                setDarkMode(!isDarkMode);
            });
        }

        function handleBookChange() {
            const selectedSlug = bookSelect.value;
            const selectedBook = BOM_BOOKS.find(book => book.slug === selectedSlug);
            
            chapterSelect.innerHTML = '';
            
            if (selectedBook) {
                for (let i = 1; i <= selectedBook.chapters; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    chapterSelect.appendChild(option);
                }
                chapterSelect.value = 1;
            }
        }

        function startLectio() {
            const selectedSlug = bookSelect.value;
            const selectedChapter = parseInt(chapterSelect.value, 10);
            
            if (selectedSlug && selectedChapter) {
                window.location.hash = `#/bofm/${selectedSlug}/${selectedChapter}`;
            }
        }

        function handleRouting() {
            const hash = window.location.hash || "";
            const match = hash.match(/^#\/bofm\/([^/]+)\/(\d+)$/);
            
            if (match) {
                const route = { slug: match[1], chapter: parseInt(match[2], 10) };
                showLectioPage(route);
            } else {
                showSelectorPage();
            }
        }

        function showSelectorPage() {
            selectorPage.style.display = 'block';
            lectioPage.style.display = 'none';
        }

        function showLectioPage(route) {
            const book = BOM_BOOKS.find(b => b.slug === route.slug);
            if (!book) {
                showSelectorPage();
                return;
            }

            const title = `${book.name} ${route.chapter}`;
            lectioTitle.textContent = `${title} — Lectio`;

            // Clear previous resources
            resourcesContainer.innerHTML = '';

            // Build URLs
            const glUrl = `https://www.churchofjesuschrist.org/study/scriptures/bofm/${route.slug}/${route.chapter}?lang=eng`;
            const covenantSlug = covenantOfChristSlugMappings[route.slug];
            const covenantOfChristUrl = covenantSlug ? `https://scriptures.info/scriptures/cc/${covenantSlug}/${route.chapter}` : null;
            const parallelEditionUrl = 'https://bencrowder.net/book-of-mormon-parallel-edition';
            const plainEnglishVersionUrl = 'https://en.wikisource.org/wiki/Book_of_Mormon_(Plain_English_Version)';
            const genZTranslateUrl = `https://chatgpt.com/?q=${encodeURIComponent(`Translate the following chapter verse by verse into Gen Z. Keep the versing. Do not change any words spoken by Deity, Keep those sacred. Have the original verses in a column next to the translation. Translate all verses in the chapter. ${book.name} ${route.chapter}`)}`;
            const bookOfMormonSimplifiedUrl = 'https://bookofmormonsimplified.com';
            const grandpaDaveUrl = 'https://grandpadave.com/BookOfMormon/Book_of_Mormon.aspx';
            const museumOfBomUrl = 'https://www.mobom.org/home';
            const masterClassUrl = 'https://johnhiltoniii.com/thebookofmormon';
            const forOurDayUrl = 'https://josephsmithfoundation.org/forourday';
            const teachingsBomSem1Url = 'https://scholarsarchive.byu.edu/mi/70';
            const teachingsBomSem2Url = 'https://scholarsarchive.byu.edu/mi/71';
            const teachingsBomSem3Url = 'https://scholarsarchive.byu.edu/mi/72';
            const teachingsBomSem4Url = 'https://scholarsarchive.byu.edu/mi/73';
            const lehiInTheDesertUrl = 'https://scholarsarchive.byu.edu/mi/50/';
            const approachBomUrl = 'https://scholarsarchive.byu.edu/mi/12/';
            const sinceCumorahUrl = 'https://scholarsarchive.byu.edu/mi/75/';
            const propheticBomUrl = 'https://scholarsarchive.byu.edu/mi/88/';
            const onlineUrl = `https://bookofmormon.online/read/${route.slug}.${route.chapter}`;
            const learningToLoveUrl = `https://clearldsdoctrine.neocities.org/ltltbom/${route.slug}/${route.chapter}`;
            const chatGptUrl = `https://chatgpt.com/?q=${encodeURIComponent(`Tell me more about ${book.name} ${route.chapter} in the Book of Mormon`)}`;
            const generateQuestionsAiUrl = `https://chatgpt.com/?q=${encodeURIComponent(`Give me some Deep study questions for this chapter in the Book of Mormon ${book.name} ${route.chapter}`)}`;
            const lessonPage = findLessonPage(route.slug, route.chapter);
            const harderUrl = lessonPage ? `https://scholarsarchive.byu.edu/cgi/viewcontent.cgi?article=1015&context=mi#page=${lessonPage}` : null;
            const seminaryManualUrl = findSeminaryManualUrl(route.slug, route.chapter);
            const studentManualUrl = findStudentManualUrl(route.slug, route.chapter);
            const bookOfMormonCentralUrl = findBookOfMormonCentralUrl(route.slug, route.chapter);
            const citationIndexUrl = 'https://scriptures.byu.edu/#::c';
            const tabernacleChoirUrl = 'https://www.churchofjesuschrist.org/media/radio/tabernacle-choir-stream?lang=eng';
            const ldsBotUrl = 'https://ldsbot.com';
            const comeFollowMeManualUrl = findComeFollowMeManualUrl(route.slug, route.chapter);
            const bookOfMormonVideoUrl = findBookOfMormonVideoUrl(route.slug, route.chapter);
            const bookOfMormonEvidenceUrl = 'https://bookofmormonevidence.org';
            const bookOfMormonArtCatalogUrl = 'https://bookofmormonartcatalog.org';
            const fairAnswersUrl = 'https://www.fairlatterdaysaints.org/answers/Book_of_Mormon';
            const byuSpeechesUrl = 'https://speeches.byu.edu/topics/book-of-mormon';
            const generalConferenceUrl = 'https://www.churchofjesuschrist.org/study/general-conference/topics/book-of-mormon?lang=eng';

            // Create and append resource categories
            const categories = [
                createResourceCategory('Translations', [
                    createButton('Open in Gospel Library', glUrl, 'gospel-library'),
                    covenantOfChristUrl && createButton('COVENANT OF CHRIST', covenantOfChristUrl, 'covenant-of-christ'),
                    createButton('Parallel Edition', parallelEditionUrl, 'parallel-edition'),
                    createButton('Plain English Version', plainEnglishVersionUrl, 'plain-english-version'),
                    createButton('Book of Mormon Simplified', bookOfMormonSimplifiedUrl, 'book-of-mormon-simplified'),
                    createButton("Grandpa Dave's Red-Letter Edition", grandpaDaveUrl, 'grandpa-dave'),
                    createButton('Translate Chapter into Gen Z (AI)', genZTranslateUrl, 'gen-z-translate')
                ]),
                createResourceCategory('Come Follow Me', [
                    comeFollowMeManualUrl && createButton('Come, Follow Me—For Home and Church', comeFollowMeManualUrl, 'come-follow-me-manual'),
                    bookOfMormonCentralUrl && createButton('Book of Mormon Central', bookOfMormonCentralUrl, 'book-of-mormon-central')
                ]),
                createResourceCategory('Study Questions', [
                    harderUrl && createButton('Book of Mormon Made Harder', harderUrl, 'book-harder'),
                    seminaryManualUrl && createButton('Book of Mormon Seminary Student Manual (2024)', seminaryManualUrl, 'seminary-manual'),
                    studentManualUrl && createButton('Book of Mormon Student Manual', studentManualUrl, 'student-manual'),
                    createButton('Generate Deep Study Questions (AI)', generateQuestionsAiUrl, 'generate-questions-ai')
                ]),
                createResourceCategory('Incredible Tools', [
                    createButton('Book of Mormon Online', onlineUrl, 'book-online'),
                    createButton('Learning to Love', learningToLoveUrl, 'learning-to-love'),
                    citationIndexUrl && createButton('Scripture Citation Index', citationIndexUrl, 'scripture-citation-index'),
                    createButton('Museum of the Book of Mormon', museumOfBomUrl, 'museum-of-bom'),
                ]),
                 createResourceCategory('Books', [
                    createButton('Lehi in the Desert...', lehiInTheDesertUrl, 'lehi-in-desert'),
                    createButton('An Approach to the Book of Mormon', approachBomUrl, 'approach-bom'),
                    createButton('Since Cumorah', sinceCumorahUrl, 'since-cumorah'),
                    createButton('The Prophetic Book of Mormon', propheticBomUrl, 'prophetic-bom')
                ]),
                createResourceCategory('Classes', [
                    createButton('The Book of Mormon: A Master Class', masterClassUrl, 'master-class'),
                    createButton('For Our Day', forOurDayUrl, 'for-our-day'),
                    createButton('Teachings of the Book of Mormon, Semester 1', teachingsBomSem1Url, 'teachings-bom'),
                    createButton('Teachings of the Book of Mormon, Semester 2', teachingsBomSem2Url, 'teachings-bom-2'),
                    createButton('Teachings of the Book of Mormon, Semester 3', teachingsBomSem3Url, 'teachings-bom-3'),
                    createButton('Teachings of the Book of Mormon, Semester 4', teachingsBomSem4Url, 'teachings-bom-4')
                ]),
                 createResourceCategory('Talks', [
                    createButton('BYU Speeches', byuSpeechesUrl, 'byu-speeches'),
                    createButton('General Conference', generalConferenceUrl, 'general-conference')
                ]),
                createResourceCategory('Apologetics', [
                    createButton('Book of Mormon Evidence', bookOfMormonEvidenceUrl, 'bom-evidence'),
                    createButton('FAIR Answers', fairAnswersUrl, 'fair-answers')
                ]),
                createResourceCategory('Entertainment', [
                    createButton('Book of Mormon Videos', bookOfMormonVideoUrl, 'book-of-mormon-videos'),
                    createButton('Book of Mormon Art Catalogue', bookOfMormonArtCatalogUrl, 'bom-art-catalog')
                ]),
                createResourceCategory('AI', [
                    createButton('Ask ChatGPT', chatGptUrl, 'chatgpt'),
                    createButton('LDSBot', ldsBotUrl, 'ldsbot')
                ]),
                createResourceCategory('Ambience', [
                    createButton('myNoise®', 'https://mynoise.net/noiseMachines.php', 'mynoise'),
                    createButton('Tabernacle Choir Stream', tabernacleChoirUrl, 'tabernacle-choir')
                ])
            ];

            categories.forEach(cat => {
                if (cat) resourcesContainer.appendChild(cat);
            });

            selectorPage.style.display = 'none';
            lectioPage.style.display = 'block';
        }

        function backToSelector() {
            window.location.hash = '';
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

