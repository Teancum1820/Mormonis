<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lectio Divina Mormonis - Celestial Remix</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: #0F0C29;
            background: -webkit-linear-gradient(to right, #24243E, #302B63, #0F0C29);
            background: linear-gradient(to right, #24243E, #302B63, #0F0C29);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }
        
        .main-container {
            width: 100%;
            max-width: 768px;
            background: rgba(20, 16, 50, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: 12px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 32px 40px;
        }
        
        .selector-page {
            text-align: center;
        }
        
        .main-title {
            font-size: 2.8rem;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 8px;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }
        
        .main-title::after {
            content: '';
            display: block;
            width: 150px;
            height: 2px;
            background: linear-gradient(to right, transparent, #00FFFF, transparent);
            margin: 12px auto;
        }
        
        .subtitle {
            color: #c0c0e0;
            margin-bottom: 32px;
            font-weight: 300;
            font-size: 1.1rem;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }
        
        .form-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #d0d0f0;
            margin-bottom: 8px;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        
        .form-select {
            border-radius: 6px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            background: rgba(30, 25, 70, 0.8);
            padding: 12px 16px;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            color: #FFFFFF;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2300FFFF' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 14px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
            transition: all 0.2s ease-in-out;
        }
        
        .form-select:focus {
            outline: none;
            border-color: #00FFFF;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        .start-button {
            border-radius: 6px;
            padding: 14px 24px;
            font-weight: 600;
            background: linear-gradient(145deg, #00FFFF, #008B8B);
            color: #0F0C29;
            border: none;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
            transition: all 0.3s ease;
        }
        
        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.6);
        }
        
        .help-text {
            font-size: 0.875rem;
            color: #a0a0c0;
            font-style: italic;
        }
        
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 0.8rem;
            color: #9090b0;
        }
        
        .footer a {
            color: #00FFFF;
            text-decoration: none;
            font-weight: 600;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .disclaimer {
            margin-top: 8px;
            font-size: 0.7rem;
            color: #707090;
        }
        
        .lectio-page {
            display: none;
            text-align: left;
        }
        
        .nav-bar {
            margin-bottom: 24px;
        }
        
        .back-button {
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            font-size: 0.9rem;
            color: #FFFFFF;
            background: rgba(30, 25, 70, 0.8);
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            transition: all 0.2s ease;
        }
        
        .back-button:hover {
            background: rgba(50, 45, 90, 1);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        .lectio-header h2 {
            font-size: 2.2rem;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 8px;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }
        
        .lectio-header p {
            color: #c0c0e0;
            margin-bottom: 24px;
            font-size: 1rem;
        }
        
        .method-text {
            font-weight: 600;
            color: #FFD700; /* Gold */
        }
        
        .resources-container {
            margin-bottom: 32px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .resource-category {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 16px;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            padding-bottom: 8px;
        }

        .category-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .resource-button {
            border-radius: 6px;
            padding: 12px 20px;
            color: #FFFFFF;
            font-weight: 600;
            text-decoration: none;
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }
        
        .resource-button:hover {
            transform: scale(1.05);
        }
        
        .gospel-library { background: #007bff; }
        .book-harder   { background: #6f42c1; }
        .book-online   { background: #17a2b8; }
        .mynoise       { background: #fd7e14; }
        .chatgpt       { background: #28a745; }
        .learning-to-love { background: #dc3545; }
        .seminary-manual { background: #ffc107; color: #212529; }
        
        .study-section {
            margin-top: 32px;
            background: rgba(0, 0, 0, 0.25);
            padding: 24px;
            border-radius: 8px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .study-section h3 {
            color: #FFFFFF;
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            text-align: center;
            letter-spacing: 0.02em;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        
        .lectio-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .lectio-step {
            background: rgba(15, 12, 41, 0.7);
            padding: 24px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .lectio-step h4 {
            color: #00FFFF;
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 1.15rem;
        }
        
        .lectio-step p {
            color: #d0d0f0;
            font-size: 0.95rem;
            line-height: 1.6;
            font-weight: 300;
        }
        
        @media (max-width: 640px) {
            .main-container { padding: 16px 24px; }
            .main-title { font-size: 2.2rem; }
            .form-grid { grid-template-columns: 1fr; }
            .category-buttons { flex-direction: column; }
            .lectio-steps { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="selector-page" id="selector-page">
            <header>
                <h1 class="main-title">Lectio Divina Mormonis</h1>
                <p class="subtitle">A Celestial Remix for scripture study</p>
            </header>

            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Book</label>
                    <select id="book-select" class="form-select"></select>
                </div>

                <div class="form-group">
                    <label class="form-label">Chapter</label>
                    <select id="chapter-select" class="form-select"></select>
                </div>
            </div>

            <div style="display: flex; align-items: center; justify-content:center; gap: 12px; margin-top: 24px;">
                <button id="start-lectio" class="start-button" onclick="startLectio()">
                    Begin Study
                </button>
            </div>

            <footer class="footer">
                © 2025 <a href="https://calebday.com" target="_blank" rel="noopener noreferrer">Caleb Day</a> | Remix by Gemini
                <div class="disclaimer">Mormonis is not affiliated with The Church of Jesus Christ of Latter-day Saints.</div>
            </footer>
        </div>

        <div class="lectio-page" id="lectio-page">
            <nav class="nav-bar">
                <button class="back-button" onclick="backToSelector()">
                    ← Select Chapter
                </button>
            </nav>

            <header class="lectio-header">
                <h2 id="lectio-title">Chapter — Lectio</h2>
                <p>Follow the divine pattern: <span class="method-text">Narrative</span>, <span class="method-text">Allegory</span>, <span class="method-text">Reflection</span>, and <span class="method-text">Invitation</span>.</p>
            </header>

            <div class="resources-container" id="resources-container">
                </div>

            <div class="study-section">
                <h3>The Four Steps</h3>
                <div class="lectio-steps">
                    <div class="lectio-step">
                        <h4>📖 Narrative</h4>
                        <p>What is the plain, literal story being told?</p>
                    </div>
                    <div class="lectio-step">
                        <h4>🔍 Allegory</h4>
                        <p>What are the symbols, types, and deeper meanings?</p>
                    </div>
                    <div class="lectio-step">
                        <h4>💭 Reflection</h4>
                        <p>How does this passage speak to me, right now?</p>
                    </div>
                    <div class="lectio-step">
                        <h4>🎯 Invitation</h4>
                        <p>What action is the Spirit inviting me to take?</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // JavaScript logic remains the same as it is independent of the design.
        // It handles populating books/chapters and generating resource links.
        
        // Book of Mormon data
        const BOM_BOOKS = [
            { name: "1 Nephi", slug: "1-ne", chapters: 22 }, { name: "2 Nephi", slug: "2-ne", chapters: 33 }, { name: "Jacob", slug: "jacob", chapters: 7 }, { name: "Enos", slug: "enos", chapters: 1 }, { name: "Jarom", slug: "jarom", chapters: 1 }, { name: "Omni", slug: "omni", chapters: 1 }, { name: "Words of Mormon", slug: "w-of-m", chapters: 1 }, { name: "Mosiah", slug: "mosiah", chapters: 29 }, { name: "Alma", slug: "alma", chapters: 63 }, { name: "Helaman", slug: "hel", chapters: 16 }, { name: "3 Nephi", slug: "3-ne", chapters: 30 }, { name: "4 Nephi", slug: "4-ne", chapters: 1 }, { name: "Mormon", slug: "morm", chapters: 9 }, { name: "Ether", slug: "ether", chapters: 15 }, { name: "Moroni", slug: "moro", chapters: 10 }
        ];

        // Lesson to PDF page mapping
        const LESSON_PAGES = [
            { range: [{ slug: "1-ne", chapters: [1,2,3,4,5,6,7] }], page: 28 }, { range: [{ slug: "1-ne", chapters: [8,9,10,11,12,15] }], page: 36 }, { range: [{ slug: "1-ne", chapters: [12,13,14] }], page: 44 }, { range: [{ slug: "1-ne", chapters: [16,17,18,19,20,21,22] }], page: 52 }, { range: [{ slug: "2-ne", chapters: [1,2] }], page: 60 }, { range: [{ slug: "2-ne", chapters: [3,4,5] }], page: 70 }, { range: [{ slug: "2-ne", chapters: [6,7,8,9,10] }], page: 76 }, { range: [{ slug: "2-ne", chapters: Array.from({length:15}, (_,i)=>i+11) }], page: 90 }, { range: [{ slug: "2-ne", chapters: [26,27,28,29,30] }], page: 100 }, { range: [{ slug: "2-ne", chapters: [31,32,33] }], page: 108 }, { range: [{ slug: "jacob", chapters: [1,2,3,4] }], page: 114 }, { range: [{ slug: "jacob", chapters: [5,6,7] }], page: 122 }, { range: [{ slug: "enos", chapters: [1]}, {slug:"jarom", chapters:[1]}, {slug:"omni", chapters:[1]}, {slug:"w-of-m", chapters:[1]}], page: 130 }, { range: [{ slug: "mosiah", chapters: [1,2,3] }], page: 136 }, { range: [{ slug: "mosiah", chapters: [4,5,6] }], page: 146 }, { range: [{ slug: "mosiah", chapters: [7,8,9,10,11] }], page: 160 }, { range: [{ slug: "mosiah", chapters: [12,13,14,15,16,17] }], page: 164 }, { range: [{ slug: "mosiah", chapters: [18,19,20,21,22,23,24] }], page: 176 }, { range: [{ slug: "mosiah", chapters: [25,26,27,28]}, {slug: "alma", chapters: [36]}], page: 180 }, { range: [{ slug: "mosiah", chapters: [29]}, {slug:"alma", chapters:[1,2,3,4]}], page: 190 }, { range: [{ slug: "alma", chapters: [5,6,7] }], page: 196 }, { range: [{ slug: "alma", chapters: [8,9,10,11,12] }], page: 204 }, { range: [{ slug: "alma", chapters: [13,14,15,16] }], page: 212 }, { range: [{ slug: "alma", chapters: [17,18,19,20,21,22] }], page: 218 }, { range: [{ slug: "alma", chapters: [23,24,25,26,27,28,29] }], page: 224 }, { range: [{ slug: "alma", chapters: [30,31] }], page: 230 }, { range: [{ slug: "alma", chapters: [32,33,34,35] }], page: 236 }, { range: [{ slug: "alma", chapters: [36,37,38,39] }], page: 250 }, { range: [{ slug: "alma", chapters: [40,41,42] }], page: 256 }, { range: [{ slug: "alma", chapters: [43,44,45,46,47,48,49,50,51,52] }], page: 262 }, { range: [{ slug: "alma", chapters: [53,54,55,56,57,58,59,60,61,62,63] }], page: 266 }, { range: [{ slug: "hel", chapters: [1,2,3,4,5] }], page: 270 }, { range: [{ slug: "hel", chapters: [6,7,8,9,10,11,12] }], page: 278 }, { range: [{ slug: "hel", chapters: [13,14,15,16] }], page: 288 }, { range: [{ slug: "3-ne", chapters: [1,2,3,4,5,6,7] }], page: 294 }, { range: [{ slug: "3-ne", chapters: [8,9,10,11] }], page: 298 }, { range: [{ slug: "3-ne", chapters: [12,13,14,15] }], page: 304 }, { range: [{ slug: "3-ne", chapters: [17,18,19] }], page: 318 }, { range: [{ slug: "3-ne", chapters: [16,20,21] }], page: 324 }, { range: [{ slug: "3-ne", chapters: [22,23,24,25,26] }], page: 328 }, { range: [{ slug: "3-ne", chapters: [27,28,29,30]}, {slug:"4-ne", chapters:[1]}], page: 332 }, { range: [{ slug: "morm", chapters: [1,2,3,4,5,6]}, {slug:"moro", chapters:[9]}], page: 338 }, { range: [{ slug: "morm", chapters: [7,8,9] }], page: 344 }, { range: [{ slug: "ether", chapters: [1,2,3,4,5,6] }], page: 350 }, { range: [{ slug: "ether", chapters: [7,8,9,10,11,12,13,14,15] }], page: 356 }, { range: [{ slug: "moro", chapters: [1,2,3,4,5,6] }], page: 360 }, { range: [{ slug: "moro", chapters: [7,8,10] }], page: 364 }
        ];

        // Seminary Manual URLs
        const seminaryMappings = [
                { range: [{ slug: "1-ne", chapters: [1,2,3,4,5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/03-1-nephi-1-5/031-student?lang=eng" }, { range: [{ slug: "1-ne", chapters: [6,7,8,9,10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/04-1-nephi-6-10/041-student?lang=eng" }, { range: [{ slug: "1-ne", chapters: [11,12,13,14,15] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/05-1-nephi-11-15/051-student?lang=eng" }, { range: [{ slug: "1-ne", chapters: [16,17,18,19,20,21,22] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/06-1-nephi-16-22/061-student?lang=eng" }, { range: [{ slug: "2-ne", chapters: [1,2] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/07-2-nephi-1-2/071-student?lang=eng" }, { range: [{ slug: "2-ne", chapters: [3,4,5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/08-2-nephi-3-5/081-student?lang=eng" }, { range: [{ slug: "2-ne", chapters: [6,7,8,9,10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/09-2-nephi-6-10/091-student?lang=eng" }, { range: [{ slug: "2-ne", chapters: [11,12,13,14,15,16,17,18,19] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/10-2-nephi-11-19/101-student?lang=eng" }, { range: [{ slug: "2-ne", chapters: [20,21,22,23,24,25] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/11-2-nephi-20-25/111-student?lang=eng" }, { range: [{ slug: "2-ne", chapters: [26,27,28,29,30] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/12-2-nephi-26-30/121-student?lang=eng" }, { range: [{ slug: "2-ne", chapters: [31,32,33] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/13-2-nephi-31-33/131-student?lang=eng" }, { range: [{ slug: "jacob", chapters: [1,2,3,4] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/14-jacob-1-4/141-student?lang=eng" }, { range: [{ slug: "jacob", chapters: [5,6,7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/15-jacob-5-7/151-student?lang=eng" }, { range: [{ slug: "enos", chapters: [1] }, { slug: "jarom", chapters: [1] }, { slug: "omni", chapters: [1] }, { slug: "w-of-m", chapters: [1] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/16-enos-words-of-mormon/161-student?lang=eng" }, { range: [{ slug: "mosiah", chapters: [1,2,3] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/17-mosiah-1-3/171-student?lang=eng" }, { range: [{ slug: "mosiah", chapters: [4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/18-mosiah-4-6/181-student?lang=eng" }, { range: [{ slug: "mosiah", chapters: [7,8,9,10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/19-mosiah-7-10/191-student?lang=eng" }, { range: [{ slug: "mosiah", chapters: [11,12,13,14,15,16,17] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/20-mosiah-11-17/201-student?lang=eng" }, { range: [{ slug: "mosiah", chapters: [18,19,20,21,22,23,24] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/21-mosiah-18-24/211-student?lang=eng" }, { range: [{ slug: "mosiah", chapters: [25,26,27,28] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/22-mosiah-25-28/221-student?lang=eng" }, { range: [{ slug: "mosiah", chapters: [29] }, { slug: "alma", chapters: [1,2,3,4] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/23-mosiah-29-alma-4/231-student?lang=eng" }, { range: [{ slug: "alma", chapters: [5,6,7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/24-alma-5-7/241-student?lang=eng" }, { range: [{ slug: "alma", chapters: [8,9,10,11,12] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/25-alma-8-12/251-student?lang=eng" }, { range: [{ slug: "alma", chapters: [13,14,15,16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/26-alma-13-16/261-student?lang=eng" }, { range: [{ slug: "alma", chapters: [17,18,19,20,21,22] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/27-alma-17-22/271-student?lang=eng" }, { range: [{ slug: "alma", chapters: [23,24,25,26,27,28,29] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/28-alma-23-29/281-student?lang=eng" }, { range: [{ slug: "alma", chapters: [30,31] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/29-alma-30-31/291-student?lang=eng" }, { range: [{ slug: "alma", chapters: [32,33,34,35] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/30-alma-32-35/301-student?lang=eng" }, { range: [{ slug: "alma", chapters: [36,37,38] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/31-alma-36-38/311-student?lang=eng" }, { range: [{ slug: "alma", chapters: [39,40,41,42] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/32-alma-39-42/321-student?lang=eng" }, { range: [{ slug: "alma", chapters: [43,44,45,46,47,48,49,50,51,52] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/33-alma-43-52/331-student?lang=eng" }, { range: [{ slug: "alma", chapters: [53,54,55,56,57,58,59,60,61,62,63] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/34-alma-53-63/341-student?lang=eng" }, { range: [{ slug: "hel", chapters: [1,2,3,4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/35-helaman-1-6/351-student?lang=eng" }, { range: [{ slug: "hel", chapters: [7,8,9,10,11,12] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/36-helaman-7-12/361-student?lang=eng" }, { range: [{ slug: "hel", chapters: [13,14,15,16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/37-helaman-13-16/371-student?lang=eng" }, { range: [{ slug: "3-ne", chapters: [1,2,3,4,5,6,7] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/38-3-nephi-1-7/381-student?lang=eng" }, { range: [{ slug: "3-ne", chapters: [8,9,10,11] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/39-3-nephi-8-11/391-student?lang=eng" }, { range: [{ slug: "3-ne", chapters: [12,13,14,15,16] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/40-3-nephi-12-16/401-student?lang=eng" }, { range: [{ slug: "3-ne", chapters: [17,18,19] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/41-3-nephi-17-19/411-student?lang=eng" }, { range: [{ slug: "3-ne", chapters: [20,21,22,23,24,25,26] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/42-3-nephi-20-26/421-student?lang=eng" }, { range: [{ slug: "3-ne", chapters: [27,28,29,30] }, { slug: "4-ne", chapters: [1] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/43-3-nephi-27-4-nephi-1/431-student?lang=eng" }, { range: [{ slug: "morm", chapters: [1,2,3,4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/44-mormon-1-6/441-student?lang=eng" }, { range: [{ slug: "morm", chapters: [7,8,9] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/45-mormon-7-9/451-student?lang=eng" }, { range: [{ slug: "ether", chapters: [1,2,3,4,5] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/46-ether-1-5/461-student?lang=eng" }, { range: [{ slug: "ether", chapters: [6,7,8,9,10,11] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/47-ether-6-11/471-student?lang=eng" }, { range: [{ slug: "ether", chapters: [12,13,14,15] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/48-ether-12-15/481-student?lang=eng" }, { range: [{ slug: "moro", chapters: [1,2,3,4,5,6] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/49-moroni-1-6/491-student?lang=eng" }, { range: [{ slug: "moro", chapters: [7,8,9] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/50-moroni-7-9/501-student?lang=eng" }, { range: [{ slug: "moro", chapters: [10] }], url: "https://www.churchofjesuschrist.org/study/manual/book-of-mormon-seminary-student-manual-2024/51-moroni-10/511-student?lang=eng" }
            ];

        // DOM elements
        const selectorPage = document.getElementById('selector-page');
        const lectioPage = document.getElementById('lectio-page');
        const bookSelect = document.getElementById('book-select');
        const chapterSelect = document.getElementById('chapter-select');
        const lectioTitle = document.getElementById('lectio-title');
        const resourcesContainer = document.getElementById('resources-container');

        // Utility functions
        function findLessonPage(slug, chapter) {
            for (const lesson of LESSON_PAGES) {
                for (const entry of lesson.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) return lesson.page;
                }
            }
            return null;
        }

        function findSeminaryManualUrl(slug, chapter) {
            for (const mapping of seminaryMappings) {
                for (const entry of mapping.range) {
                    if (entry.slug === slug && entry.chapters.includes(chapter)) return mapping.url;
                }
            }
            return null;
        }

        function createResourceCategory(title, buttons) {
            if (buttons.length === 0) return null;
            const category = document.createElement('div');
            category.className = 'resource-category';
            const categoryTitle = document.createElement('h3');
            categoryTitle.className = 'category-title';
            categoryTitle.textContent = title;
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'category-buttons';
            buttons.forEach(button => buttonContainer.appendChild(button));
            category.appendChild(categoryTitle);
            category.appendChild(buttonContainer);
            return category;
        }

        function createButton(text, url, className) {
            const button = document.createElement('a');
            button.href = url;
            button.target = '_blank';
            button.rel = 'noopener noreferrer';
            button.className = `resource-button ${className}`;
            button.textContent = text;
            return button;
        }

        // Initialize app
        function init() {
            populateBooks();
            setupEventListeners();
            handleRouting();
        }

        function populateBooks() {
            BOM_BOOKS.forEach(book => {
                const option = document.createElement('option');
                option.value = book.slug;
                option.textContent = book.name;
                bookSelect.appendChild(option);
            });
            handleBookChange();
        }

        function setupEventListeners() {
            bookSelect.addEventListener('change', handleBookChange);
            window.addEventListener('hashchange', handleRouting);
        }

        function handleBookChange() {
            const selectedBook = BOM_BOOKS.find(book => book.slug === bookSelect.value);
            chapterSelect.innerHTML = '';
            if (selectedBook) {
                for (let i = 1; i <= selectedBook.chapters; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    chapterSelect.appendChild(option);
                }
            }
        }

        function startLectio() {
            if (bookSelect.value && chapterSelect.value) {
                window.location.hash = `#/bofm/${bookSelect.value}/${chapterSelect.value}`;
            }
        }

        function handleRouting() {
            const match = (window.location.hash || "").match(/^#\/bofm\/([^/]+)\/(\d+)$/);
            if (match) {
                showLectioPage({ slug: match[1], chapter: parseInt(match[2], 10) });
            } else {
                showSelectorPage();
            }
        }

        function showSelectorPage() {
            selectorPage.style.display = 'block';
            lectioPage.style.display = 'none';
        }

        function showLectioPage(route) {
            const book = BOM_BOOKS.find(b => b.slug === route.slug);
            if (!book) { showSelectorPage(); return; }

            lectioTitle.textContent = `${book.name} ${route.chapter} — Lectio`;
            resourcesContainer.innerHTML = '';

            const glUrl = `https://www.churchofjesuschrist.org/study/scriptures/bofm/${route.slug}/${route.chapter}?lang=eng`;
            const onlineUrl = `https://bookofmormon.online/read/${route.slug}.${route.chapter}`;
            const learningToLoveUrl = `https://clearldsdoctrine.neocities.org/ltltbom/${route.slug}/${route.chapter}`;
            const chatGptUrl = `https://chatgpt.com/?q=${encodeURIComponent(`Tell me more about ${book.name} ${route.chapter} in the Book of Mormon`)}`;
            const harderUrl = findLessonPage(route.slug, route.chapter) ? `https://scholarsarchive.byu.edu/cgi/viewcontent.cgi?article=1015&context=mi#page=${findLessonPage(route.slug, route.chapter)}` : null;
            const seminaryManualUrl = findSeminaryManualUrl(route.slug, route.chapter);

            const categories = [
                createResourceCategory('Scripture Text', [createButton('Gospel Library', glUrl, 'gospel-library')]),
                createResourceCategory('Study Guides', [
                    harderUrl && createButton('Book of Mormon Made Harder', harderUrl, 'book-harder'),
                    seminaryManualUrl && createButton('Seminary Student Manual (2024)', seminaryManualUrl, 'seminary-manual')
                ].filter(Boolean)),
                createResourceCategory('Commentary & Tools', [
                    createButton('Book of Mormon Online', onlineUrl, 'book-online'),
                    createButton('Learning to Love', learningToLoveUrl, 'learning-to-love')
                ]),
                createResourceCategory('AI & Ambience', [
                    createButton('Ask ChatGPT', chatGptUrl, 'chatgpt'),
                    createButton('myNoise®', 'https://mynoise.net/noiseMachines.php', 'mynoise')
                ]),
            ];

            categories.forEach(cat => { if (cat) resourcesContainer.appendChild(cat); });

            selectorPage.style.display = 'none';
            lectioPage.style.display = 'block';
        }

        function backToSelector() {
            window.location.hash = '';
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
